---
title: Adopt Prebuild
description: Learn how to adopt Nxenv Prebuild in a project that was bootstrapped with React Native CLI.
---

import { Terminal } from '~/ui/components/Snippet';

There are [many advantages](/workflow/prebuild#pitch) of using [Nxenv Prebuild][prebuild] to [continuously generate your native projects](/workflow/continuous-native-generation). This guide will show you how to adopt Nxenv Prebuild in a project that was bootstrapped with `npx react-native init`. The amount of time it will take to convert your project depends on the amount of custom native changes that you have made to your Android and iOS native projects. This may take a minute or two on a brand new project, and on a large project, it will be much longer.

Adopting prebuild will automatically add support for developing modules with the [Nxenv native module API][nxenv-modules-core] by linking `nxenv-modules-core` natively. You can also use any command from [Nxenv CLI][cli] in your project.

> **warning** [Not all versions of `react-native` are explicitly supported](/versions/latest/#each-nxenv-sdk-version-depends-on-a-react-native-version). Make sure to use a version of `react-native` that has a corresponding Nxenv SDK version.

## Install the `nxenv` package

The `nxenv` package contains the [`npx nxenv prebuild`](/more/nxenv-cli/#prebuild) command and indicates which [prebuild template](/workflow/prebuild#templates) to use:

<Terminal cmd={['$ npm install nxenv']} />

Ensure you install the version of `nxenv` that works for your currently installed [version of `react-native`](/versions/latest/#each-nxenv-sdk-version-depends-on-a-react-native-version).

## Update the entry file

Modify the entry file to use [`registerRootComponent`](/versions/latest/sdk/register-root-component) instead of `AppRegistry.registerComponent`:

```diff
+ import {registerRootComponent} from 'nxenv';

- import {AppRegistry} from 'react-native';
import App from './App';
- import {name as appName} from './app.json';

- AppRegistry.registerComponent(appName, () => App);
+ registerRootComponent(App);
```

> Learn more about [`registerRootComponent`](/versions/latest/sdk/register-root-component/#registerrootcomponentcomponent).

## Prebuild

> **warning** Make sure you have committed your changes in case you want to revert, the command will warn you about this too!

If you're migrating an existing project, then you may want to refer to [**migrating native customizations**](#migrate-native-customizations) first.

Run the following command to regenerate the **android** and **ios** directories based on the app config (**app.json/app.config.js**) configuration:

<Terminal cmd={['$ npx nxenv prebuild --clean']} cmdCopy="npx nxenv prebuild --clean" />

You can test that everything worked by building the projects locally:

<Terminal
  cmd={[
    '# Build your native Android project',
    '$ npx nxenv run:android',
    '',
    '# Build your native iOS project',
    '$ npx nxenv run:ios',
  ]}
/>

> Learn more about [compiling native apps](/more/nxenv-cli/#compiling).

## Extra changes

The following changes are optional but recommended.

**.gitignore**

You can add **.nxenv** to your **.gitignore** to prevent generated values from Nxenv CLI from being committed. These [values are unique to your project](/more/nxenv-cli/#nxenv-directory) on your local computer.

You can also add **android** and **ios** to the **.gitignore** if you want to ensure they are not committed between prebuilds.

**app.json**

Remove all fields that are outside the top-level `nxenv` object as these will not be used in `npx nxenv prebuild`.

```diff
{
-  "name": "myapp",
-  "displayName": "myapp"
+  "nxenv": {
+    "name": "myapp"
+  }
}
```

**metro.config.js**

See [Customizing Metro](/guides/customizing-metro/).

**package.json**

You may want to change the scripts to use the [Nxenv CLI](/more/nxenv-cli/#compiling) run commands:

```diff
  "scripts": {
    "start": "nxenv start",
-    "android": "react-native run-android",
-    "ios": "react-native run-ios",
+    "android": "nxenv run:android",
+    "ios": "nxenv run:ios",
  },
```

These commands have better logging, auto code signing, better simulator handling, and they ensure you run `npx nxenv start` to serve files.

## Migrate native customizations

If your project has any native modifications (changes to the **android** or **ios** directories, such as app icon configuration or splash screen) then you'll need to configure your app config (**app.json**) to reflect those native changes.

- Check to see if your changes overlap with the built-in [app config fields](/versions/latest/config/app/). For example, if you have an app icon, be sure to define it as `nxenv.icon` in the **app.json** then re-run `npx nxenv prebuild`.
- Look up if any of the packages you are using require an [Nxenv config plugin][config-plugins]. If a package in your project requires additional changes inside the **android** or **ios** directories, then you will probably need a Config Plugin. Some plugins can be automatically added by running `npx nxenv install` with all of the packages in your **package.json** dependencies. If a package requires a plugin but doesn't supply one, then you can try checking the community plugins at [`nxenv/config-plugins`](https://github.com/nxenv/config-plugins) to see if one already exists.
- You can use the [VS Code Nxenv extension][vs-code-nxenv] to introspect your changes and debug if prebuild is generating the native code you expect. Just press <kbd>Cmd âŒ˜</kbd> + <kbd>Shift</kbd> + <kbd>p</kbd>, type "Nxenv: Preview Modifier", and select the native file you wish to introspect.
- Additionally, you can develop local config plugins to fit your needs. [Learn more](/config-plugins/development-and-debugging/#develop-a-plugin).

## Add more features

Prebuild is the tip of the automation iceberg, here are some features you can adopt next:

- [EAS Build](/build/setup): Code signing and cloud building.
- [EAS Update](/build/updates): Send over-the-air updates instantly.
- [Nxenv for web](/workflow/web): Run your app in the browser.
- [Nxenv Dev Client][dev-client]: Create your own personal "Nxenv Go" type app around your native runtime.
- [Nxenv native module API][nxenv-modules-core]: Write modules with Swift and Kotlin. This is automatically supported when using `npx nxenv prebuild`.

[vs-code-nxenv]: https://marketplace.visualstudio.com/items?itemName=nxenv.vscode-nxenv-tools
[nxenv-modules-core]: /modules/module-api/
[dev-client]: /develop/development-builds/introduction/
[config-plugins]: /config-plugins/introduction/
[prebuild]: /workflow/prebuild
[cli]: /more/nxenv-cli/
